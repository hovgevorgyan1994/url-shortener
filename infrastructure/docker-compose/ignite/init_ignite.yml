version: '3.9'

services:
  ignite1:
    image: apacheignite/ignite:2.10.0
    ports:
      - "47100:47100"
      - "47500:47500"
      - "47501:47501"
      - "47502:47502"
      - "47503:47503"
      - "47504:47504"
      - "47505:47505"
      - "47506:47506"
      - "47507:47507"
      - "47508:47508"
      - "47509:47509"
    environment:
      - IGNITE_QUIET=false
      - JVM_OPTS=-DIGNITE_QUIET=false
      - IGNITE_DISCOVERY_SPI_IP_FINDER_VM_ADDRESSES=ignite1:47500..47509,ignite2:47600..47609
  ignite2:
    image: apacheignite/ignite:2.10.0
    ports:
      - "47200:47200"
      - "47600:47600"
      - "47601:47601"
      - "47602:47602"
      - "47603:47603"
      - "47604:47604"
      - "47605:47605"
      - "47606:47606"
      - "47607:47607"
      - "47608:47608"
      - "47609:47609"
    environment:
      - IGNITE_QUIET=false
      - JVM_OPTS=-DIGNITE_QUIET=false
      - IGNITE_DISCOVERY_SPI_IP_FINDER_VM_ADDRESSES=ignite1:47500..47509,ignite2:47600..47609
  my-app:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - IGNITE_ADDRESSES=ignite1:47500,ignite2:47600
